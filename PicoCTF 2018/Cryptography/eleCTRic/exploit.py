#!/usr/bin/env python2
from pwn import *
from base64 import b64decode,b64encode
r = remote("2018shell.picoctf.com", 42185)
r.recvuntil("Please choose:")
r.sendline("n")
r.sendline("A"*16)
r.sendline("anything")
r.recvuntil("Share code:")
r.recvline()
share = r.recvline().strip()
encryptedNullBytes = ""
decoded_share = b64decode(share)
for c in decoded_share:
	encryptedNullBytes+=chr(ord(c)^ord("A"))
r.sendline("i")
r.recvuntil("Files:")
r.recvline()
flag_name = r.recvline().strip()
fake_share = ""
for i in range(len(flag_name)):
	fake_share += chr(ord(flag_name[i])^ord(encryptedNullBytes[i%16]))
fake_share = b64encode(fake_share)
r.sendline("e")
r.sendline(fake_share)
r.sendline("x")
print(r.recvall())